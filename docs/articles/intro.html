<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to persistent homology with TDAstats • TDAstats</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to persistent homology with TDAstats">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TDAstats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/inference.html">Hypothesis testing with TDAstats</a>
    </li>
    <li>
      <a href="../articles/inputformat.html">Data Input for TDAstats</a>
    </li>
    <li>
      <a href="../articles/intro.html">Introduction to persistent homology with TDAstats</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rrrlw/TDAstats">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to persistent homology with TDAstats</h1>
                        <h4 class="author">Raoul R. Wadhwa, Drew F.K. Williamson, Andrew Dhawan, Jacob G. Scott</h4>
            
            <h4 class="date">24 July 2018</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rrrlw/TDAstats/blob/master/vignettes/intro.Rmd"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<div id="purpose" class="section level2">
<h2 class="hasAnchor">
<a href="#purpose" class="anchor"></a>Purpose</h2>
<p>TDAstats is intended to be a comprehensive R pipeline to conduct topological data analysis, specifically, using persistent homology of a Vietoris-Rips complex to identify significant features within high-dimensional datasets. The three primary functions of TDAstats mirror the functionality of tools used to conduct traditional statistical analysis (e.g. simple linear regression). Listed below are the three functions and their analogs in simple linear regression.</p>
<ol style="list-style-type: decimal">
<li>
<strong>Calculation of persistent homology:</strong> analogous to calculating the slope and intercept of a line of best fit.</li>
<li>
<strong>Visualization of persistent homology:</strong> analogous to plotting a scatterplot to visualize a dataset.</li>
<li>
<strong>Hypothesis testing on persistent homology:</strong> analogous to conducting Student’s <em>t</em>-test to determine if two sets of data have significantly differing means.</li>
</ol>
<p>To learn more about the computation of persistent homology, see <span class="citation">Otter et al. (2017)</span>.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>TDAstats is available on CRAN. The development version can also be installed from its <a href="https://github.com/rrrlw/TDAstats">GitHub repo</a>. Use the appropriate selections of the R code below to install your preferred version.</p>
<p><em>N.B.:</em> if you are new to R, installing TDAstats from CRAN is recommended. The development version on GitHub may be unstable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install development version of TDAstats - advanced users</span>
devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"rrrlw/TDAstats"</span>)

<span class="co"># install TDAstats from CRAN</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"TDAstats"</span>)

<span class="co"># load TDAstats for use</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"TDAstats"</span>)</code></pre></div>
</div>
<div id="sample-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#sample-dataset" class="anchor"></a>Sample dataset</h2>
<p>In this vignette, we will use the <code>circle2d</code> dataset included in TDAstats. The <code>circle2d</code> dataset is a numeric matrix containing the 2-dimensional Cartesian coordinates of 100 points on the circumference of a unit circle centered at the origin. To load <code>circle2d</code> and take a quick peek, run the following R code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load dataset</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(circle2d)

<span class="co"># look at the dimensions and class of circle2d</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(circle2d)
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="st">"matrix"</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(circle2d)
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">100</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(circle2d)
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="dv">2</span>

<span class="co"># take a peek at first 6 rows</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(circle2d)
<span class="op">&gt;</span><span class="st">             </span>[,<span class="dv">1</span>]       [,<span class="dv">2</span>]
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>,] <span class="op">-</span><span class="fl">0.09728967</span>  <span class="fl">0.9952561</span>
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">2</span>,] <span class="op">-</span><span class="fl">0.69421384</span>  <span class="fl">0.7197688</span>
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">3</span>,] <span class="op">-</span><span class="fl">0.89704859</span> <span class="op">-</span><span class="fl">0.4419319</span>
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">4</span>,]  <span class="fl">0.83824069</span> <span class="op">-</span><span class="fl">0.5453004</span>
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">5</span>,]  <span class="fl">0.29894927</span>  <span class="fl">0.9542690</span>
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">6</span>,]  <span class="fl">0.80302853</span> <span class="op">-</span><span class="fl">0.5959406</span></code></pre></div>
<p>Above, each of the 100 rows represents a single point, with each of the 2 columns representing a Cartesian coordinate for a single dimension. Column 1 (accessed by <code>circle2d[, 1]</code>) contains the x-coordinates of the 100 points and column 2 (accessed by <code>circle2d[, 2]</code>) contains the respective y-coordinates. To confirm that the points in <code>circle2d</code> do lie on the circumference of a circle, we can quickly create a scatterplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># scatterplot of circle2d</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(circle2d, <span class="dt">xlab =</span> <span class="st">"x"</span>, <span class="dt">ylab =</span> <span class="st">"y"</span>, <span class="dt">main =</span> <span class="st">"Point cloud in circle2d dataset"</span>)</code></pre></div>
<p><img src="intro_files/figure-html/plot-circle2d-1.png" width="384"></p>
</div>
<div id="calculating-persistent-homology" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-persistent-homology" class="anchor"></a>Calculating persistent homology</h2>
<p>Given that the points in <code>circle2d</code> are uniformly distributed across the circumference of a circle without any error or noise, we expect a single prominent 1-cycle to be present in its persistent homology. The <a href="https://github.com/Ripser/ripser">Ripser</a> C++ library is wrapped by R using <a href="https://github.com/RcppCore/Rcpp">Rcpp</a>, and performs calculations on a Vietoris-Rips complex created using the <code>circle2d</code> point cloud <span class="citation">(Eddelbuettel and Francois 2011)</span>. These calculations result in a numeric matrix that contains all the necessary information to characterize the persistence of features within <code>circle2d</code>, and can be performed with a single line of R code using TDAstats.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate persistent homology</span>
circle.phom &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calculate_homology.html">calculate_homology</a></span>(circle2d)

<span class="co"># print first 6 features (ordered by dimension and birth)</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(circle.phom)
<span class="op">&gt;</span><span class="st">      </span>dimension birth        death
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>,]         <span class="dv">0</span>     <span class="dv">0</span> <span class="fl">0.0007823978</span>
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">2</span>,]         <span class="dv">0</span>     <span class="dv">0</span> <span class="fl">0.0024476588</span>
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">3</span>,]         <span class="dv">0</span>     <span class="dv">0</span> <span class="fl">0.0043431663</span>
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">4</span>,]         <span class="dv">0</span>     <span class="dv">0</span> <span class="fl">0.0050472712</span>
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">5</span>,]         <span class="dv">0</span>     <span class="dv">0</span> <span class="fl">0.0055217817</span>
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">6</span>,]         <span class="dv">0</span>     <span class="dv">0</span> <span class="fl">0.0058158724</span>

<span class="co"># print last 6 features (ordered by dimension and birth)</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">tail</a></span>(circle.phom)
<span class="op">&gt;</span><span class="st">        </span>dimension     birth     death
<span class="op">&gt;</span><span class="st">  </span>[<span class="dv">95</span>,]         <span class="dv">0</span> <span class="fl">0.0000000</span> <span class="fl">0.1655777</span>
<span class="op">&gt;</span><span class="st">  </span>[<span class="dv">96</span>,]         <span class="dv">0</span> <span class="fl">0.0000000</span> <span class="fl">0.1676424</span>
<span class="op">&gt;</span><span class="st">  </span>[<span class="dv">97</span>,]         <span class="dv">0</span> <span class="fl">0.0000000</span> <span class="fl">0.1724907</span>
<span class="op">&gt;</span><span class="st">  </span>[<span class="dv">98</span>,]         <span class="dv">0</span> <span class="fl">0.0000000</span> <span class="fl">0.1962725</span>
<span class="op">&gt;</span><span class="st">  </span>[<span class="dv">99</span>,]         <span class="dv">0</span> <span class="fl">0.0000000</span> <span class="fl">0.2085510</span>
<span class="op">&gt;</span><span class="st"> </span>[<span class="dv">100</span>,]         <span class="dv">1</span> <span class="fl">0.2232352</span> <span class="fl">1.7339087</span></code></pre></div>
<p>Each row in the homology matrix returned by the <code>calculate_homology</code> function (variable named <code>circle.phom</code>) represents a single feature (cycle). The homology matrix has 3 columns in the following order:</p>
<ol style="list-style-type: decimal">
<li>
<strong>dimension:</strong> if 0, represents a 0-cycle; if 1, represents a 1-cycle; and so on.</li>
<li>
<strong>birth:</strong> the radius of the Vietoris-Rips complex at which this feature was first detected.</li>
<li>
<strong>death:</strong> the radius of the Vietoris-Rips complex at which this feature was last detected.</li>
</ol>
<p>Persistence of a feature is generally defined as the length of the interval of the radius within which the feature exists. This can be calculated as the numerical difference between the second (birth) and third (death) columns of the homology matrix. Confirmed in the output of the <code>head</code> and <code>tail</code> functions above, the homology matrix is ordered by dimension, with the birth column used to compare features of the same dimension. As expected for <code>circle2d</code>, the homology matrix contains a single prominent 1-cycle (last line of the output of <code>tail</code>). Although we suspect the feature to be a persistent 1-cycle, comparison with the other features in the homology matrix is required to confirm that it is sufficiently persistent. This task is done far more easily with an appropriate visualization than by eyeballing the contents of <code>circle.phom</code>.</p>
</div>
<div id="visualizing-persistent-homology" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-persistent-homology" class="anchor"></a>Visualizing persistent homology</h2>
<p>TDAstats uses the <a href="http://ggplot2.org">ggplot2</a> R package to create visualizations for persistent homology <span class="citation">(Wickham 2009)</span>. One method of visualizing persistent homology is the topological barcode. Each feature is depicted by a single bar (ergo, a topological <em>barcode</em>) with its left edge at feature birth and its right edge at feature death. Thus, the persistence of a feature is depicted as the length of the bar. The horizontal axis of the barcode represents the Vietoris-Rips complex radius; the vertical axis is not inherently meaningful and is not strictly ordered. By convention, the order of features is in reverse of the order in the homology matrix. Hence, the dimension of features increases as you go higher up the vertical axis, as does the value of feature birth. For ease of interpretation, feature dimension is coded as the bar’s color, with an accompanying legend.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot topological barcode</span>
<span class="kw"><a href="../reference/plot_barcode.html">plot_barcode</a></span>(circle.phom)</code></pre></div>
<p><img src="intro_files/figure-html/plot-barcode-1.png" width="576"></p>
<p>In the topological barcode plotted above, we see a number of 0-cycles (red bars). However, of interest to us is the single 1-cycle at the top of the barcode (blue bar). A quick visual evaluation of the barcode confirms that the 1-cycle is clearly a significant feature (the blue bar is relatively long), as expected for <code>circle2d</code>. Congratulations, you have successfully used TDAstats to conduct topological data analysis on a point cloud!</p>
<p>Another method of visualizing persistent homology is the persistence diagram. Each feature is depicted by a single point with the horizontal axis representing feature birth and the vertical axis representing feature death. The line <span class="math inline">\(y = x\)</span> is included as a reference. Since feature birth always precedes feature death (<span class="math inline">\(x &lt; y\)</span>), all points in a persistence diagram lie above the reference line. In persistence diagrams, the persistence of a feature is depicted as the vertical distance between the point representing the feature and the reference line. Just like topological barcodes, feature dimension is coded as the point’s color, with an accompanying legend; however, feature dimension is redundantly coded as point shape in case of issues with color differentiation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot persistence diagram</span>
<span class="kw"><a href="../reference/plot_persist.html">plot_persist</a></span>(circle.phom)</code></pre></div>
<p><img src="intro_files/figure-html/plot-persist-1.png" width="576"></p>
<p>In the persistence diagram plotted above, we see a number of 0-cycles (red circles); it is difficult to differentiate individual 0-cycles due to the overlap between points. However, the single 1-cycle is distinct (blue triangle), again confirming our initial proposition that the persistent homology of <code>circle2d</code> would be significant for a single prominent 1-cycle. When evaluating persistence diagrams, it must be kept in mind that a point’s y-coordinate by itself is not an accurate measure of feature persistence; rather, it is the vertical distance between the point and the reference line that represents persistence.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Rcpp-paper">
<p>Eddelbuettel, Dirk, and Romain Francois. 2011. “Rcpp: Seamless R and C++ Integration.” <em>Journal of Statistical Software</em> 40: 1–18. doi:<a href="https://doi.org/10.18637/jss.v040.i08">10.18637/jss.v040.i08</a>.</p>
</div>
<div id="ref-roadmap-ph">
<p>Otter, Nina, Mason Porter, Ulrike Tillmann, Peter Grindrod, and Heather Harrington. 2017. “A Roadmap for the Computation of Persistent Homology.” <em>EPJ Data Science</em> 6: 17. doi:<a href="https://doi.org/10.1140/epjds/s13688-017-0109-5">10.1140/epjds/s13688-017-0109-5</a>.</p>
</div>
<div id="ref-ggplot2-book">
<p>Wickham, Hadley. 2009. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="http://ggplot2.org" class="uri">http://ggplot2.org</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#purpose">Purpose</a></li>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#sample-dataset">Sample dataset</a></li>
      <li><a href="#calculating-persistent-homology">Calculating persistent homology</a></li>
      <li><a href="#visualizing-persistent-homology">Visualizing persistent homology</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Raoul Wadhwa, Andrew Dhawan, Drew Williamson, Jacob Scott.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
